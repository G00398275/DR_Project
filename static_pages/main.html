<!DOCTYPE html>
<html>
    <head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
 integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <title>Quarterback Statistics 2022</title>
    </head>
<style>

.table{
    border-collapse: collapse;
    margin: 25px 0;
    font-size: 0.9em;
    font-family: sans-serif;
    min-width: 400px;
    box-shadow: 0 0 20px rgba(2, 0, 40, 0.15);
}

</style>

    <body>
            <h1>Quarterbacks Stats 2022</h1>

            <div>
                <button id = "button-showCreate" onclick="showCreate()">Create</button>
            </div>

            <div>
                <table class = "table" id = "QBTable" border = "1">
                    <tr>
                        <th>id</th>
                        <th>Name</th>
                        <th>Team</th>
                        <th>Passing Yards</th>
                        <th>TDs</th>
                        <th>INTs</th>
                        <th>Update</th>
                        <th>Delete</th> 
                    </tr>
                    <tr id = "1">
                        <td>1</td>
                        <td>Patrick Mahomes</td>
                        <td>Kansas City Chiefs</td>
                        <td>3585</td>
                        <td>29</td>
                        <td>8</td>
                        <td><button onclick = "showUpdate(this)">update</button></td>
                        <td><button onclick = "doDelete(this)">delete</button></td>
                    </tr>

                </table>
            </div>
           
            <div id = 'createUpdateForm' style= "display:none">
                <h2>
                    <span id = "createLabel"> Create a</span>
                    <span id = "updateLabel"> Update this</span>QB
                </h2>
                id <input type = "text" name = "id"><br/>
                Name <input type = "text" name = "Name"></br>
                Team <input type = "text" name = "Team"></br>
                Passing Yards <input type = "number" name = "Passing Yards"></br>
                TDs <input type = "number" name = "TDs"></br>
                INTs <input type = "number" name = "INTs"></br>
                </select><br/>
                <span><button id = "button-doCreate" onclick = "doCreate()">Create</button></span>
            <span><button id = "button-doUpdate" onclick = "doUpdate()">Update</button></span>
            </div>
    </body>

<script>
//console.log("Hello world")

function showCreate(){
    document.getElementById('createUpdateForm').style.display="block"

    document.getElementById('button-doCreate').style.display="block"
    document.getElementById('button-doUpdate').style.display="none"

    document.getElementById('createLabel').style.display="inline"
    document.getElementById('updateLabel').style.display="none"

    document.getElementById('button-showCreate').style.display="none"
    document.getElementById('QBTable').style.display="none"
}

function showViewAll(){
    document.getElementById('createUpdateForm').style.display="none"

    document.getElementById('button-showCreate').style.display="block"
    document.getElementById('QBTable').style.display="block"
}


function clearForm(){
    var form = document.getElementById("createUpdateForm")

    form.querySelector('input[name = "id"]').disabled = false
    form.querySelector('input[name = "id"]').value =''
    form.querySelector('input[name = "Name"]').value = ''
    form.querySelector('input[name = "Team"]').value = ''
    form.querySelector('input[name = "Passing Yards"]').value = ''
    form.querySelector('input[name = "TDs"]').value = ''
    form.querySelector('input[name = "INTs"]').value = ''
}

function getQBFromForm(){
    var form = document.getElementById("createUpdateForm")
    var QB = {}

    QB.id = form.querySelector('input[name = "id"]').value
    QB.Name = form.querySelector('input[name = "Name"]').value
    QB.Team = form.querySelector('input[name = "Team"]').value
    QB.Passing_Yards = form.querySelector('input[name = "Passing Yards"]').value
    QB.TDs = form.querySelector('input[name = "TDs"]').value
    QB.INTs = form.querySelector('input[name = "INTs"]').value
    //console.log(JSON.stringify(QB))
    return QB

}
function showUpdate(buttonElement){
    document.getElementById('createUpdateForm').style.display="block"
    
    document.getElementById('button-doCreate').style.display="none"
    document.getElementById('button-doUpdate').style.display="block"

    document.getElementById('createLabel').style.display="none"
    document.getElementById('updateLabel').style.display="inline"

    document.getElementById('button-showCreate').style.display="none"
    document.getElementById('QBTable').style.display="none"

    var rowElement = buttonElement.parentNode.parentNode //finding closest <tr>, can use closest() also

    var QB = getQBFromRow(rowElement)
    populateFormWithQB(QB)
}

function addQBToTable(QB){
    var tableElement = document.getElementById('QBTable')
    var rowElement = tableElement.insertRow(-1) // Adds to last row of table
    rowElement.setAttribute('id', QB.id)
    var cell1 = rowElement.insertCell(0);
    cell1.innerHTML = QB.id
    var cell2 = rowElement.insertCell(1);
    cell2.innerHTML = QB.Name
    var cell3 = rowElement.insertCell(2);
    cell3.innerHTML = QB.Team
    var cell4 = rowElement.insertCell(3);
    cell4.innerHTML = QB.Passing_Yards
    var cell4 = rowElement.insertCell(4);
    cell4.innerHTML = QB.TDs
    var cell4 = rowElement.insertCell(5);
    cell4.innerHTML = QB.INTs
    var cell5 = rowElement.insertCell(6);
    cell5.innerHTML = '<button onclick = "showUpdate(this)">Update</button>'
    var cell6 = rowElement.insertCell(7);
    cell6.innerHTML = '<button onclick = "doDelete(this)">Delete</button>'

}

function getQBFromRow(rowElement){
    var QB = {}
    QB.id = rowElement.cells[0].firstChild.textContent
    QB.Name = rowElement.cells[1].firstChild.textContent
    QB.Team = rowElement.cells[2].firstChild.textContent
    QB.Passing_Yards = rowElement.cells[3].firstChild.textContent
    QB.TDs = rowElement.cells[4].firstChild.textContent
    QB.INTs = rowElement.cells[5].firstChild.textContent
    return QB
}

function setQBInRow(rowElement, QB){
    rowElement.cells[0].firstChild.textContent = QB.id
    rowElement.cells[1].firstChild.textContent = QB.Name
    rowElement.cells[2].firstChild.textContent = QB.Team
    rowElement.cells[3].firstChild.textContent = QB.Passing_Yards
    rowElement.cells[4].firstChild.textContent = QB.TDs
    rowElement.cells[5].firstChild.textContent = QB.INTs
    return QB
}

function populateFormWithQB(QB){
    var form = document.getElementById('createUpdateForm')
    form.querySelector('input[name="id"]').disabled = true
    form.querySelector('input[name="id"]').value = QB.id
    form.querySelector('input[name="Name"]').value = QB.Name
    form.querySelector('input[name="Team"]').value = QB.Team
    form.querySelector('input[name="Passing Yards"]').value = QB.Passing_Yards
    form.querySelector('input[name="TDs"]').value = QB.TDs
    form.querySelector('input[name="INTs"]').value = QB.INTs
}

function doCreate(){
    QB = getQBFromForm()
    console.log(QB)
    addQBToTable(QB)
    showViewAll()
    clearForm()
}

function doUpdate(){
    console.log("Updating Quarterback")
    var QB = getQBFromForm()
    var rowElement = document.getElementById(QB.id)
    setQBInRow(rowElement, QB)
    showViewAll()
    clearForm()
}

function doDelete(buttonElement){
    console.log("Deleting")
    var tableElement = document.getElementById('QBTable')
    var index = buttonElement.parentNode.parentNode.rowIndex
    tableElement.deleteRow(index)
}

</script>
</html>